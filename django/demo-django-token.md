## 如何实现基于Token认证后端API服务

大家好，今天我们分享的主题为「如何实现基于Token认证后端API服务？」。

### Token 认证机制 

#### 什么是Token 认证机制 ？

首先让我们来了解下token认证机制，顾名思义`token`就是令牌的意思，就想武侠剧中象征着各种权利的令牌一样，这个令牌是一种身份的象征。在我们的系统中，token是一串字符串，这个令牌主要用做客户端请求服务端时的身份认证。

Token认证机制大体是这样的。首先，你向系统申请一个token，这个申请方式可以是用户名密码的验证，也可以是系统管理员直接给你分配的，这完全取决于后端系统的设计。之后在调用系统接口的时候，带上这个token，可以是放到header里，也可以直接放到url里，只要和后端协商好就好。

这是一个典型的Token认证流程，可以看这张图：

![](https://pylixm.top/static/imgs/jwt_cookie/token.png)

- 1/ 用户使用用户名和密码登录，将用户名和密码发送给服务器。
- 2/ 服务器验证用户名和密码，若正确，则签发token，返回给用户。
- 3/ 用户收到token后，将其存储起来，web服务一般为localStrage 或cookie。
- 4/ 用户请求其他资源页面时，会携带token，一般放到header 或参数中，发送给服务端。
- 5/ 服务器收到后，验证token，判断用户的正确性。

#### 为什么要用Token 认证机制 ？

Token认证机制与我们常用的用户名密码认证机制有什么好处呢？

- 使用用户名密码登录之后，浏览器会保存我们登录的标识sessionid。这说明我们的服务便是一个有状态的服务，在扩展服务节点的时候，就会涉及到session的同步问题。
- 其次，sessionid是保存在cookie 中的，这很容易引起CSRF攻击。
- token 完全是有后端来控制的，和浏览器解耦，可以完全避免浏览器的同源策略，避免跨域问题及由此引起的一系列安全问题。

#### 怎么使用Token认证机制呢？

下章我们使用一个案例来具体，说明下在我们的django中，如何使用Token认证机制。


### 使用Django 实现一个简单的Token认证

> TODO 